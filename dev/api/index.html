<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API Reference · SpectroscopyTools.jl</title><meta name="title" content="API Reference · SpectroscopyTools.jl"/><meta property="og:title" content="API Reference · SpectroscopyTools.jl"/><meta property="twitter:title" content="API Reference · SpectroscopyTools.jl"/><meta name="description" content="Documentation for SpectroscopyTools.jl."/><meta property="og:description" content="Documentation for SpectroscopyTools.jl."/><meta property="twitter:description" content="Documentation for SpectroscopyTools.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SpectroscopyTools.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/chirp_correction/">Chirp Correction</a></li></ul></li><li class="is-active"><a class="tocitem" href>API Reference</a><ul class="internal"><li><a class="tocitem" href="#Types"><span>Types</span></a></li><li><a class="tocitem" href="#chirp-api"><span>Chirp Correction</span></a></li><li><a class="tocitem" href="#SVD-Filtering"><span>SVD Filtering</span></a></li><li><a class="tocitem" href="#Cosmic-Ray-Detection"><span>Cosmic Ray Detection</span></a></li><li><a class="tocitem" href="#PL-/-Raman-Mapping"><span>PL / Raman Mapping</span></a></li><li><a class="tocitem" href="#Peak-Fitting"><span>Peak Fitting</span></a></li><li><a class="tocitem" href="#Peak-Detection"><span>Peak Detection</span></a></li><li><a class="tocitem" href="#Exponential-Decay-Fitting"><span>Exponential Decay Fitting</span></a></li><li><a class="tocitem" href="#Baseline-Correction"><span>Baseline Correction</span></a></li><li><a class="tocitem" href="#Spectroscopy-Utilities"><span>Spectroscopy Utilities</span></a></li><li><a class="tocitem" href="#Unit-Conversions"><span>Unit Conversions</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/garrekstemo/SpectroscopyTools.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/main/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="api-reference"><a class="docs-heading-anchor" href="#api-reference">API Reference</a><a id="api-reference-1"></a><a class="docs-heading-anchor-permalink" href="#api-reference" title="Permalink"></a></h1><h2 id="Types"><a class="docs-heading-anchor" href="#Types">Types</a><a id="Types-1"></a><a class="docs-heading-anchor-permalink" href="#Types" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="SpectroscopyTools.SpectroscopyTools"><a class="docstring-binding" href="#SpectroscopyTools.SpectroscopyTools"><code>SpectroscopyTools.SpectroscopyTools</code></a> — <span class="docstring-category">Module</span></summary><section><div><p>SpectroscopyTools.jl — General-purpose spectroscopy analysis toolkit.</p><p>Provides data types, fitting routines, baseline correction, peak detection, unit conversions, and utility functions for spectroscopic data analysis.</p><p>Extracted from QPS.jl to serve as a standalone, reusable foundation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/SpectroscopyTools.jl#L1-L8">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.AbstractSpectroscopyData"><a class="docstring-binding" href="#SpectroscopyTools.AbstractSpectroscopyData"><code>SpectroscopyTools.AbstractSpectroscopyData</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">AbstractSpectroscopyData</code></pre><p>Abstract base type for all spectroscopy data types.</p><p>Subtypes must implement the following interface:</p><ul><li><code>xdata(d)</code> — Primary x-axis data (Vector{Float64})</li><li><code>ydata(d)</code> — Signal data (Vector{Float64}) or secondary axis for 2D</li><li><code>zdata(d)</code> — Matrix data for 2D types, <code>nothing</code> for 1D</li><li><code>xlabel(d)</code> — X-axis label string</li><li><code>ylabel(d)</code> — Y-axis or signal label string</li><li><code>is_matrix(d)</code> — Whether data is 2D (returns Bool)</li></ul><p>Optional (have defaults):</p><ul><li><code>source_file(d)</code> — Source filename (default: <code>&quot;&quot;</code>)</li><li><code>npoints(d)</code> — Number of data points (default: <code>length(xdata(d))</code>, tuple for 2D)</li><li><code>title(d)</code> — Display title (default: <code>source_file(d)</code>)</li></ul><p>This enables uniform handling in data viewers and plotting functions while maintaining semantic field names in each concrete type.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs"># Works for any spectroscopy data type
function plot_data(data::AbstractSpectroscopyData)
    if is_matrix(data)
        heatmap(xdata(data), ydata(data), zdata(data)&#39;)
    else
        lines(xdata(data), ydata(data))
    end
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/types.jl#L9-L41">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.TATrace"><a class="docstring-binding" href="#SpectroscopyTools.TATrace"><code>SpectroscopyTools.TATrace</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">TATrace &lt;: AbstractSpectroscopyData</code></pre><p>Single-wavelength transient absorption kinetic trace.</p><p><strong>Fields</strong></p><ul><li><code>time::Vector{Float64}</code>: Time axis (ps)</li><li><code>signal::Vector{Float64}</code>: ΔA signal</li><li><code>wavelength::Float64</code>: Probe wavelength, NaN if unknown</li><li><code>metadata::Dict{Symbol,Any}</code>: Additional info</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/types.jl#L80-L90">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.TASpectrum"><a class="docstring-binding" href="#SpectroscopyTools.TASpectrum"><code>SpectroscopyTools.TASpectrum</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">TASpectrum &lt;: AbstractSpectroscopyData</code></pre><p>Transient absorption spectrum at a fixed time delay.</p><p><strong>Fields</strong></p><ul><li><code>wavenumber::Vector{Float64}</code>: Wavenumber axis (cm⁻¹)</li><li><code>signal::Vector{Float64}</code>: ΔA signal</li><li><code>time_delay::Float64</code>: Time delay (ps), NaN if unknown</li><li><code>metadata::Dict{Symbol,Any}</code>: Additional info</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/types.jl#L148-L158">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.TAMatrix"><a class="docstring-binding" href="#SpectroscopyTools.TAMatrix"><code>SpectroscopyTools.TAMatrix</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">TAMatrix &lt;: AbstractSpectroscopyData</code></pre><p>Two-dimensional transient absorption data (time x wavelength).</p><p><strong>Fields</strong></p><ul><li><code>time::Vector{Float64}</code>: Time axis (ps)</li><li><code>wavelength::Vector{Float64}</code>: Wavelength axis (nm) or wavenumber (cm⁻¹)</li><li><code>data::Matrix{Float64}</code>: ΔA signal matrix, size (n<em>time, n</em>wavelength)</li><li><code>metadata::Dict{Symbol,Any}</code>: Additional info</li></ul><p><strong>Indexing</strong></p><pre><code class="language-julia hljs">matrix[λ=800]     # Extract TATrace at λ ≈ 800 nm
matrix[t=1.0]     # Extract TASpectrum at t ≈ 1.0 ps</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/types.jl#L658-L674">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.TASpectrumFit"><a class="docstring-binding" href="#SpectroscopyTools.TASpectrumFit"><code>SpectroscopyTools.TASpectrumFit</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">TASpectrumFit</code></pre><p>Result of TA spectrum fitting with N peaks of arbitrary lineshape.</p><p>Supports any combination of ESA, GSB, and SE peaks, each with its own lineshape model (Gaussian, Lorentzian, pseudo-Voigt).</p><p><strong>Access peaks</strong></p><ul><li><code>result.peaks</code> — Vector of <code>TAPeak</code></li><li><code>result[i]</code> — i-th peak</li><li><code>result[:esa]</code> — first peak with label <code>:esa</code></li><li><code>anharmonicity(result)</code> — GSB center minus ESA center (NaN if not applicable)</li></ul><p><strong>Fields</strong></p><ul><li><code>peaks::Vector{TAPeak}</code> — Fitted peak parameters</li><li><code>offset</code>, <code>rsquared</code>, <code>residuals</code> — Fit metadata</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/types.jl#L248-L265">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.TAPeak"><a class="docstring-binding" href="#SpectroscopyTools.TAPeak"><code>SpectroscopyTools.TAPeak</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">TAPeak</code></pre><p>Information about a single peak in a TA spectrum fit.</p><p><strong>Fields</strong></p><ul><li><code>label::Symbol</code> — Peak type (<code>:esa</code>, <code>:gsb</code>, <code>:se</code>, <code>:positive</code>, <code>:negative</code>)</li><li><code>model::String</code> — Lineshape model name (<code>&quot;gaussian&quot;</code>, <code>&quot;lorentzian&quot;</code>, <code>&quot;pseudo_voigt&quot;</code>)</li><li><code>center::Float64</code> — Peak center position</li><li><code>width::Float64</code> — Width parameter (sigma for gaussian/voigt, fwhm for lorentzian)</li><li><code>amplitude::Float64</code> — Peak amplitude (always positive; sign determined by label)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/types.jl#L215-L226">source</a></section></details></article><h2 id="chirp-api"><a class="docs-heading-anchor" href="#chirp-api">Chirp Correction</a><a id="chirp-api-1"></a><a class="docs-heading-anchor-permalink" href="#chirp-api" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="SpectroscopyTools.ChirpCalibration"><a class="docstring-binding" href="#SpectroscopyTools.ChirpCalibration"><code>SpectroscopyTools.ChirpCalibration</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">ChirpCalibration</code></pre><p>Stores the result of chirp detection: detected chirp points, polynomial fit, and detection parameters for reproducibility.</p><p><strong>Fields</strong></p><ul><li><code>wavelength</code>: Wavelength points where chirp was detected (nm)</li><li><code>time_offset</code>: Detected chirp time at each wavelength (ps)</li><li><code>poly_coeffs</code>: Polynomial fit coefficients (constant term first, ascending order)</li><li><code>poly_order</code>: Polynomial order used</li><li><code>reference_λ</code>: Reference wavelength where chirp = 0 (nm)</li><li><code>r_squared</code>: Polynomial fit quality</li><li><code>metadata</code>: Detection parameters for reproducibility</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/chirp.jl#L11-L25">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.detect_chirp"><a class="docstring-binding" href="#SpectroscopyTools.detect_chirp"><code>SpectroscopyTools.detect_chirp</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">detect_chirp(matrix::TAMatrix; kwargs...) -&gt; ChirpCalibration</code></pre><p>Detect chirp (GVD) in a broadband TA matrix via cross-correlation (<code>:xcorr</code>) or threshold crossing (<code>:threshold</code>). Returns a <code>ChirpCalibration</code> with polynomial fit.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/chirp.jl#L126-L131">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.correct_chirp"><a class="docstring-binding" href="#SpectroscopyTools.correct_chirp"><code>SpectroscopyTools.correct_chirp</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">correct_chirp(matrix::TAMatrix, cal::ChirpCalibration) -&gt; TAMatrix</code></pre><p>Apply chirp correction via cubic spline interpolation, shifting each wavelength column by <code>t_shift(λ)</code> from the calibration polynomial.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/chirp.jl#L488-L493">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.subtract_background"><a class="docstring-binding" href="#SpectroscopyTools.subtract_background"><code>SpectroscopyTools.subtract_background</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">subtract_background(matrix::TAMatrix; t_range=nothing) -&gt; TAMatrix</code></pre><p>Subtract pre-pump background from a TA matrix by averaging and removing the signal in the baseline region (before pump arrival).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/chirp.jl#L66-L71">source</a></section><section><div><pre><code class="language-julia hljs">subtract_background(m::PLMap; positions=nothing, margin=5) -&gt; PLMap</code></pre><p>Subtract a background spectrum from every grid point.</p><p>The background is the average CCD spectrum over the reference positions. After subtraction, the intensity map is recomputed from the corrected spectra using the same <code>pixel_range</code> as the original load (if any).</p><p><strong>Arguments</strong></p><ul><li><code>positions</code>: Vector of <code>(x, y)</code> spatial coordinate tuples (μm) for background reference points. These should be off-flake positions with no PL signal.</li><li><code>margin</code>: Number of grid points from each edge used for auto-detection when <code>positions</code> is not given. Auto mode averages the corners of the bottom half of the map (avoids top-row artifacts). Default: 5.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">m = load_pl_map(&quot;data.lvm&quot;; nx=51, ny=51, step_size=2.16, pixel_range=(950, 1100))

# Explicit background positions
m_bg = subtract_background(m; positions=[(-40, -40), (40, -40), (-40, -20)])

# Auto mode (bottom corners)
m_bg = subtract_background(m)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/plmap.jl#L110-L136">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.polynomial"><a class="docstring-binding" href="#SpectroscopyTools.polynomial"><code>SpectroscopyTools.polynomial</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">polynomial(cal::ChirpCalibration) -&gt; Function</code></pre><p>Return a callable polynomial <code>t_shift = poly(λ)</code> from the calibration. Coefficients are in ascending order: <code>c[1] + c[2]*λ + c[3]*λ² + ...</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/chirp.jl#L36-L41">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.save_chirp"><a class="docstring-binding" href="#SpectroscopyTools.save_chirp"><code>SpectroscopyTools.save_chirp</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">save_chirp(path::String, cal::ChirpCalibration)</code></pre><p>Save a chirp calibration to a JSON file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/chirp.jl#L531-L535">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.load_chirp"><a class="docstring-binding" href="#SpectroscopyTools.load_chirp"><code>SpectroscopyTools.load_chirp</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">load_chirp(path::String) -&gt; ChirpCalibration</code></pre><p>Load a chirp calibration from a JSON file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/chirp.jl#L551-L555">source</a></section></details></article><h2 id="SVD-Filtering"><a class="docs-heading-anchor" href="#SVD-Filtering">SVD Filtering</a><a id="SVD-Filtering-1"></a><a class="docs-heading-anchor-permalink" href="#SVD-Filtering" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="SpectroscopyTools.svd_filter"><a class="docstring-binding" href="#SpectroscopyTools.svd_filter"><code>SpectroscopyTools.svd_filter</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">svd_filter(matrix::TAMatrix; n_components::Int=5) -&gt; TAMatrix</code></pre><p>Denoise a TA matrix by keeping only the first <code>n_components</code> singular value components. Higher-order components (dominated by noise) are discarded.</p><p>This is a standard preprocessing step for broadband TA data. Typical usage: denoise first, then subtract background, detect chirp, and correct chirp.</p><p><strong>Arguments</strong></p><ul><li><code>matrix::TAMatrix</code>: Input time × wavelength ΔA matrix</li></ul><p><strong>Keywords</strong></p><ul><li><code>n_components::Int=5</code>: Number of singular value components to retain. Use <a href="#SpectroscopyTools.singular_values"><code>singular_values</code></a> to inspect the spectrum and choose.</li></ul><p><strong>Returns</strong></p><p>A new <code>TAMatrix</code> with filtered data. Metadata includes <code>:svd_filtered =&gt; true</code> and <code>:svd_n_components =&gt; n_components</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">sv = singular_values(matrix)  # inspect singular value spectrum
filtered = svd_filter(matrix; n_components=3)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/chirp.jl#L580-L605">source</a></section><section><div><pre><code class="language-julia hljs">svd_filter(x::AbstractVector, y::AbstractVector, data::AbstractMatrix;
           n_components::Int=5) -&gt; Matrix{Float64}</code></pre><p>Denoise a raw data matrix by keeping only the first <code>n_components</code> singular value components. Returns the filtered matrix.</p><p><strong>Arguments</strong></p><ul><li><code>x</code>: First axis (e.g., time)</li><li><code>y</code>: Second axis (e.g., wavelength)</li><li><code>data</code>: Matrix of size <code>(length(x), length(y))</code></li></ul><p><strong>Keywords</strong></p><ul><li><code>n_components::Int=5</code>: Number of components to retain</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/chirp.jl#L625-L639">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.singular_values"><a class="docstring-binding" href="#SpectroscopyTools.singular_values"><code>SpectroscopyTools.singular_values</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">singular_values(matrix::TAMatrix) -&gt; Vector{Float64}</code></pre><p>Return the singular values of the TA data matrix. Inspect these to choose <code>n_components</code> for <a href="#SpectroscopyTools.svd_filter"><code>svd_filter</code></a> — look for a gap between signal and noise components.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">sv = singular_values(matrix)
# Plot sv to find the elbow, then filter:
filtered = svd_filter(matrix; n_components=3)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/chirp.jl#L655-L668">source</a></section><section><div><pre><code class="language-julia hljs">singular_values(data::AbstractMatrix) -&gt; Vector{Float64}</code></pre><p>Return the singular values of a raw data matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/chirp.jl#L673-L677">source</a></section></details></article><h2 id="Cosmic-Ray-Detection"><a class="docs-heading-anchor" href="#Cosmic-Ray-Detection">Cosmic Ray Detection</a><a id="Cosmic-Ray-Detection-1"></a><a class="docs-heading-anchor-permalink" href="#Cosmic-Ray-Detection" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="SpectroscopyTools.CosmicRayResult"><a class="docstring-binding" href="#SpectroscopyTools.CosmicRayResult"><code>SpectroscopyTools.CosmicRayResult</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">CosmicRayResult</code></pre><p>Result of cosmic ray detection on a 1D signal.</p><p><strong>Fields</strong></p><ul><li><code>indices::Vector{Int}</code> — flagged channel indices</li><li><code>count::Int</code> — number of flagged channels</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/cosmic_rays.jl#L19-L27">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.CosmicRayMapResult"><a class="docstring-binding" href="#SpectroscopyTools.CosmicRayMapResult"><code>SpectroscopyTools.CosmicRayMapResult</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">CosmicRayMapResult</code></pre><p>Result of cosmic ray detection on a PLMap.</p><p><strong>Fields</strong></p><ul><li><code>mask::BitArray{3}</code> — <code>(nx, ny, n_pixel)</code>, <code>true</code> = cosmic ray</li><li><code>count::Int</code> — total flagged voxels</li><li><code>affected_spectra::Int</code> — number of spectra with at least one cosmic ray</li><li><code>channel_counts::Vector{Int}</code> — cosmic ray count per spectral channel</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/cosmic_rays.jl#L33-L43">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.detect_cosmic_rays"><a class="docstring-binding" href="#SpectroscopyTools.detect_cosmic_rays"><code>SpectroscopyTools.detect_cosmic_rays</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">detect_cosmic_rays(signal::AbstractVector; threshold=5.0) -&gt; CosmicRayResult</code></pre><p>Detect cosmic ray spikes in a 1D spectrum using modified z-scores on first differences (Whitaker-Hayes method).</p><p>Computes first differences <code>Δ[k] = signal[k+1] - signal[k]</code>, then flags channels where the modified z-score exceeds <code>threshold</code>. The modified z-score uses the Median Absolute Deviation (MAD) for robust scale estimation.</p><p><strong>Arguments</strong></p><ul><li><code>signal</code>: 1D spectral signal</li><li><code>threshold</code>: z-score cutoff (default 5.0). Lower values detect more spikes but may flag real features.</li></ul><p><strong>Returns</strong></p><p>A <a href="#SpectroscopyTools.CosmicRayResult"><code>CosmicRayResult</code></a> with the flagged channel indices.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">result = detect_cosmic_rays(spectrum; threshold=5.0)
println(&quot;Found $(result.count) cosmic rays at indices $(result.indices)&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/cosmic_rays.jl#L55-L78">source</a></section><section><div><pre><code class="language-julia hljs">detect_cosmic_rays(m::PLMap; threshold=5.0, pixel_range=nothing, max_spike_width=7) -&gt; CosmicRayMapResult</code></pre><p>Detect cosmic ray spikes across all spectra in a PLMap using nearest-neighbor comparison.</p><p>For each pixel, computes a reference spectrum as the median of its 4-connected spatial neighbors at each channel. The residual (pixel minus reference) is then tested for positive outliers using the MAD-based robust scale estimate. Channels where the residual exceeds <code>threshold × σ</code> above the median residual are flagged.</p><p>Two filters prevent false positives at spatial boundaries where spectra change:</p><ul><li><strong>Width filter</strong>: contiguous flagged runs wider than <code>max_spike_width</code> are unflagged — cosmic rays span 1–5 channels; wider runs are spectral variation.</li><li><strong>Fraction cap</strong>: if more than 5% of channels are still flagged after the width filter, all flags for that pixel are cleared.</li></ul><p>A global noise floor (median of per-pixel σ estimates) prevents over-sensitivity in spatially homogeneous regions.</p><p><strong>Arguments</strong></p><ul><li><code>m</code>: PLMap with 3D spectra array <code>(nx, ny, n_pixel)</code></li><li><code>threshold</code>: outlier cutoff in MAD-scaled units (default 5.0)</li><li><code>pixel_range</code>: <code>(start, stop)</code> channel indices to analyze. When set, only this subrange of each spectrum is checked for cosmic rays. Channels outside the range are never flagged. Defaults to the <code>pixel_range</code> in <code>m.metadata</code>, or the full spectrum if unset.</li><li><code>max_spike_width</code>: maximum width (in channels) of a contiguous flagged run to keep (default 7). Runs wider than this are unflagged as spectral variation.</li></ul><p><strong>Returns</strong></p><p>A <a href="#SpectroscopyTools.CosmicRayMapResult"><code>CosmicRayMapResult</code></a> with a 3D boolean mask and summary statistics.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">cr = detect_cosmic_rays(plmap; threshold=5.0)
println(&quot;Found $(cr.count) cosmic rays in $(cr.affected_spectra) spectra&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/cosmic_rays.jl#L266-L304">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.remove_cosmic_rays"><a class="docstring-binding" href="#SpectroscopyTools.remove_cosmic_rays"><code>SpectroscopyTools.remove_cosmic_rays</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">remove_cosmic_rays(signal::AbstractVector, result::CosmicRayResult) -&gt; Vector</code></pre><p>Replace flagged cosmic ray channels with linearly interpolated values from the nearest non-flagged neighbors.</p><p>Returns a new vector; does not mutate the input.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">result = detect_cosmic_rays(spectrum)
cleaned = remove_cosmic_rays(spectrum, result)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/cosmic_rays.jl#L160-L173">source</a></section><section><div><pre><code class="language-julia hljs">remove_cosmic_rays(m::PLMap, result::CosmicRayMapResult) -&gt; PLMap</code></pre><p>Remove cosmic rays from a PLMap by replacing flagged voxels.</p><p>For each flagged <code>(ix, iy, k)</code>: replaces with the median of <code>spectra[neighbors, k]</code> from non-flagged 4-connected spatial neighbors. Falls back to spectral interpolation (linear from nearest non-flagged channels) for edge pixels with no valid neighbors.</p><p>Returns a new PLMap with recomputed intensity.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">cr = detect_cosmic_rays(plmap)
cleaned = remove_cosmic_rays(plmap, cr)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/cosmic_rays.jl#L395-L411">source</a></section></details></article><h2 id="PL-/-Raman-Mapping"><a class="docs-heading-anchor" href="#PL-/-Raman-Mapping">PL / Raman Mapping</a><a id="PL-/-Raman-Mapping-1"></a><a class="docs-heading-anchor-permalink" href="#PL-/-Raman-Mapping" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="SpectroscopyTools.PLMap"><a class="docstring-binding" href="#SpectroscopyTools.PLMap"><code>SpectroscopyTools.PLMap</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">PLMap &lt;: AbstractSpectroscopyData</code></pre><p>Photoluminescence intensity map from a CCD raster scan.</p><p>A 2D spatial grid where each point has a full CCD spectrum. The <code>intensity</code> field holds the integrated PL signal at each position; the full spectra are stored in <code>spectra</code> for extraction at individual positions.</p><p><strong>Fields</strong></p><ul><li><code>intensity::Matrix{Float64}</code> — Integrated PL intensity <code>(nx, ny)</code></li><li><code>spectra::Array{Float64,3}</code> — Raw CCD counts <code>(nx, ny, n_pixel)</code></li><li><code>x::Vector{Float64}</code> — Spatial x positions (μm)</li><li><code>y::Vector{Float64}</code> — Spatial y positions (μm)</li><li><code>pixel::Vector{Float64}</code> — Pixel indices (or wavelength if calibrated)</li><li><code>metadata::Dict{String,Any}</code> — Source file, grid dims, step size, etc.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/plmap.jl#L7-L23">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.extract_spectrum"><a class="docstring-binding" href="#SpectroscopyTools.extract_spectrum"><code>SpectroscopyTools.extract_spectrum</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">extract_spectrum(m::PLMap, ix::Int, iy::Int) -&gt; NamedTuple</code></pre><p>Extract the CCD spectrum at grid index <code>(ix, iy)</code>.</p><p>Returns <code>(pixel=..., signal=..., x=..., y=...)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/plmap.jl#L77-L83">source</a></section><section><div><pre><code class="language-julia hljs">extract_spectrum(m::PLMap; x::Real, y::Real) -&gt; NamedTuple</code></pre><p>Extract the CCD spectrum at the spatial position nearest to <code>(x, y)</code>.</p><p>Returns <code>(pixel=..., signal=..., x=..., y=..., ix=..., iy=...)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/plmap.jl#L91-L97">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.integrated_intensity"><a class="docstring-binding" href="#SpectroscopyTools.integrated_intensity"><code>SpectroscopyTools.integrated_intensity</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">integrated_intensity(m::PLMap; pixel_range=nothing) -&gt; Matrix{Float64}</code></pre><p>Compute the integrated intensity at each grid point.</p><p>Without <code>pixel_range</code>, returns <code>m.intensity</code> (the precomputed full-range sum). With <code>pixel_range</code>, sums <code>m.spectra[:, :, p1:p2]</code> over the given pixel window.</p><p><strong>Arguments</strong></p><ul><li><code>pixel_range</code>: <code>(start, stop)</code> pixel indices to integrate over. Falls back to the <code>pixel_range</code> stored in metadata, or uses <code>m.intensity</code> if unset.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/plmap.jl#L205-L216">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.intensity_mask"><a class="docstring-binding" href="#SpectroscopyTools.intensity_mask"><code>SpectroscopyTools.intensity_mask</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">intensity_mask(m::PLMap; pixel_range=nothing, threshold=0.05, exclude=nothing) -&gt; NamedTuple</code></pre><p>Compute a boolean mask over the PLMap grid based on integrated intensity.</p><p>Grid points where the integrated intensity is below <code>threshold</code> fraction of the intensity range are excluded (<code>false</code>). Spatial regions listed in <code>exclude</code> are also set to <code>false</code> regardless of intensity. This is useful for filtering out off-sample regions and known artifacts (e.g., substrate bands) before batch operations like fitting.</p><p>The threshold is computed as: <code>cutoff = min + threshold × (max - min)</code>.</p><p><strong>Arguments</strong></p><ul><li><code>pixel_range</code>: <code>(start, stop)</code> pixel indices for computing integrated intensity. If <code>nothing</code>, uses the full precomputed <code>m.intensity</code>.</li><li><code>threshold</code>: Fraction of the intensity range (0.0 to 1.0). Default <code>0.05</code> (5%).</li><li><code>exclude</code>: Spatial regions to exclude. Each region is a tuple of x and y ranges in spatial coordinates (μm): <code>((x_min, x_max), (y_min, y_max))</code>. Accepts a single region or a vector of regions. Grid points whose spatial coordinates fall within any excluded region are masked out.</li></ul><p><strong>Returns</strong></p><p>A named tuple with fields:</p><ul><li><code>mask::BitMatrix</code> — <code>true</code> for included grid points</li><li><code>n_included::Int</code> — number of included points</li><li><code>n_total::Int</code> — total number of grid points</li><li><code>intensity_min::Float64</code> — minimum integrated intensity</li><li><code>intensity_max::Float64</code> — maximum integrated intensity</li><li><code>cutoff::Float64</code> — absolute intensity cutoff value</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">m = load_pl_map(&quot;scan.lvm&quot;; nx=51, ny=51)
m = subtract_background(m)

# Threshold only
result = intensity_mask(m; pixel_range=(950, 1100), threshold=0.1)

# Exclude a substrate band at the top of the map
result = intensity_mask(m; threshold=0.05,
    exclude=((-Inf, Inf), (40.0, Inf)))

# Multiple exclusion regions
result = intensity_mask(m; threshold=0.05,
    exclude=[
        ((-Inf, Inf), (40.0, Inf)),     # top substrate band
        ((-50.0, -40.0), (-50.0, -40.0))  # noisy corner
    ])</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/plmap.jl#L232-L282">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.peak_centers"><a class="docstring-binding" href="#SpectroscopyTools.peak_centers"><code>SpectroscopyTools.peak_centers</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">peak_centers(m::PLMap; pixel_range=nothing, threshold=0.05) -&gt; Matrix{Float64}</code></pre><p>Compute the centroid (intensity-weighted average pixel) at each grid point.</p><p>Returns a <code>(nx, ny)</code> matrix of peak center positions in pixel units. Grid points where the PL intensity (<code>m.intensity</code>) is below <code>threshold</code> × the map maximum are set to <code>NaN</code> (renders as transparent in heatmaps with <code>nan_color=:transparent</code>).</p><p>Masking uses the PLMap&#39;s intensity field — the integrated PL signal already stored in the map. This produces clean masks that match the intensity heatmap: off-flake regions (low PL signal) are transparent, on-flake regions show centroid positions.</p><p><strong>Arguments</strong></p><ul><li><code>pixel_range</code>: <code>(start, stop)</code> pixel range to compute the centroid over. Falls back to the <code>pixel_range</code> stored in metadata, or all pixels if unset.</li><li><code>threshold</code>: Fraction of the maximum PL intensity below which a grid point is masked as <code>NaN</code>. Default <code>0.05</code> (5%). Set to <code>0</code> to disable masking.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">m = load_pl_map(&quot;scan.lvm&quot;; nx=51, ny=51, pixel_range=(950, 1100))
m = subtract_background(m)
centers = peak_centers(m)
heatmap(m.x, m.y, centers; colormap=:viridis, nan_color=:transparent)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/plmap.jl#L330-L356">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.normalize_intensity"><a class="docstring-binding" href="#SpectroscopyTools.normalize_intensity"><code>SpectroscopyTools.normalize_intensity</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">normalize_intensity(m::PLMap) -&gt; PLMap</code></pre><p>Return a new PLMap with intensity normalized to [0, 1].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/plmap.jl#L186-L190">source</a></section></details></article><h2 id="Peak-Fitting"><a class="docs-heading-anchor" href="#Peak-Fitting">Peak Fitting</a><a id="Peak-Fitting-1"></a><a class="docs-heading-anchor-permalink" href="#Peak-Fitting" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="SpectroscopyTools.fit_peaks"><a class="docstring-binding" href="#SpectroscopyTools.fit_peaks"><code>SpectroscopyTools.fit_peaks</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">fit_peaks(x, y; kwargs...) -&gt; MultiPeakFitResult
fit_peaks(spec::AbstractSpectroscopyData, region; kwargs...) -&gt; MultiPeakFitResult
fit_peaks(spec::AbstractSpectroscopyData; kwargs...) -&gt; MultiPeakFitResult</code></pre><p>Fit one or more peaks in spectroscopy data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/peakfitting.jl#L136-L142">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.fit_ta_spectrum"><a class="docstring-binding" href="#SpectroscopyTools.fit_ta_spectrum"><code>SpectroscopyTools.fit_ta_spectrum</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">fit_ta_spectrum(spec::TASpectrum; kwargs...) -&gt; TASpectrumFit</code></pre><p>Fit a transient absorption spectrum with N peaks of arbitrary lineshape.</p><p>Uses <code>find_peaks</code> to automatically detect initial peak positions from the data, so multiple well-separated peaks of the same type (e.g., three GSB peaks for W(CO)₆) are initialized correctly.</p><p><strong>Keywords</strong></p><ul><li><code>peaks=[:esa, :gsb]</code> — Peak types. Each element is either a <code>Symbol</code> (<code>:esa</code>, <code>:gsb</code>, <code>:se</code>, <code>:positive</code>, <code>:negative</code>) or a <code>(Symbol, Function)</code> tuple specifying label and lineshape model.</li><li><code>model=gaussian</code> — Default lineshape for peaks specified as symbols only.</li><li><code>region=nothing</code> — Optional <code>(x_min, x_max)</code> fitting region.</li><li><code>fit_offset=false</code> — Whether to fit a constant offset.</li><li><code>p0=nothing</code> — Manual initial parameter vector. Overrides automatic detection.</li></ul><p><strong>Peak signs</strong></p><ul><li><code>:esa</code>, <code>:positive</code> → +1 (positive ΔA)</li><li><code>:gsb</code>, <code>:se</code>, <code>:negative</code> → -1 (negative ΔA)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Default: 1 Gaussian ESA + 1 Gaussian GSB
result = fit_ta_spectrum(spec)

# Three GSB peaks (e.g., W(CO)₆ carbonyl stretches)
result = fit_ta_spectrum(spec; peaks=[:esa, :esa, :esa, :gsb, :gsb, :gsb])

# Per-peak lineshapes
result = fit_ta_spectrum(spec; peaks=[(:esa, lorentzian), (:gsb, gaussian)])

# Access results
result[:esa].center      # first ESA peak
result[2].center         # second peak by index
anharmonicity(result)    # GSB - ESA center (only if exactly 1 of each)
predict(result, ν)       # full fitted curve
predict_peak(result, 1)  # single peak contribution</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/fitting.jl#L680-L720">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.MultiPeakFitResult"><a class="docstring-binding" href="#SpectroscopyTools.MultiPeakFitResult"><code>SpectroscopyTools.MultiPeakFitResult</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">MultiPeakFitResult</code></pre><p>Result of multi-peak fitting (1 to N peaks with polynomial baseline).</p><p>Supports indexing by peak number: <code>result[1]</code> returns first peak&#39;s <code>PeakFitResult</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/types.jl#L516-L522">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.PeakFitResult"><a class="docstring-binding" href="#SpectroscopyTools.PeakFitResult"><code>SpectroscopyTools.PeakFitResult</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">PeakFitResult</code></pre><p>Result of peak fitting with any lineshape model.</p><p>Access parameters by name: <code>result[:center].value</code>, <code>result[:fwhm].err</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/types.jl#L455-L461">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.anharmonicity"><a class="docstring-binding" href="#SpectroscopyTools.anharmonicity"><code>SpectroscopyTools.anharmonicity</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">anharmonicity(fit::TASpectrumFit) -&gt; Float64</code></pre><p>Compute the anharmonicity (GSB center - ESA center) from a TA spectrum fit. Returns <code>NaN</code> if there is not exactly one ESA and one GSB peak.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/types.jl#L291-L296">source</a></section></details></article><h2 id="Peak-Detection"><a class="docs-heading-anchor" href="#Peak-Detection">Peak Detection</a><a id="Peak-Detection-1"></a><a class="docs-heading-anchor-permalink" href="#Peak-Detection" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="SpectroscopyTools.PeakInfo"><a class="docstring-binding" href="#SpectroscopyTools.PeakInfo"><code>SpectroscopyTools.PeakInfo</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">PeakInfo</code></pre><p>Information about a detected peak.</p><p><strong>Fields</strong></p><ul><li><code>position::Float64</code> — Peak center in x-units</li><li><code>intensity::Float64</code> — Peak height</li><li><code>prominence::Float64</code> — How much the peak stands out from surrounding baseline</li><li><code>width::Float64</code> — Full width at half prominence (FWHP) in x-units</li><li><code>bounds::Tuple{Float64,Float64}</code> — Left and right edges at half prominence</li><li><code>index::Int</code> — Index in the original data array</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/peakdetection.jl#L12-L24">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.find_peaks"><a class="docstring-binding" href="#SpectroscopyTools.find_peaks"><code>SpectroscopyTools.find_peaks</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">find_peaks(y; kwargs...) -&gt; Vector{PeakInfo}
find_peaks(x, y; kwargs...) -&gt; Vector{PeakInfo}</code></pre><p>Find peaks in spectroscopic data.</p><p><strong>Keyword Arguments</strong></p><ul><li><code>min_prominence::Real=0.05</code> — Minimum prominence as fraction of data range</li><li><code>min_width::Real=0</code> — Minimum peak width in x-units</li><li><code>max_width::Real=Inf</code> — Maximum peak width in x-units</li><li><code>min_height::Real=-Inf</code> — Minimum peak height (absolute)</li><li><code>window::Int=1</code> — Comparison window for local maxima detection</li><li><code>baseline::Union{Symbol,Nothing}=nothing</code> — Apply baseline correction before peak detection</li><li><code>baseline_kw::NamedTuple=NamedTuple()</code> — Keyword arguments for baseline correction</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/peakdetection.jl#L51-L65">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.peak_table"><a class="docstring-binding" href="#SpectroscopyTools.peak_table"><code>SpectroscopyTools.peak_table</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">peak_table(peaks::Vector{PeakInfo}) -&gt; String</code></pre><p>Format detected peaks as an aligned text table for terminal display.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/peakdetection.jl#L161-L165">source</a></section></details></article><h2 id="Exponential-Decay-Fitting"><a class="docs-heading-anchor" href="#Exponential-Decay-Fitting">Exponential Decay Fitting</a><a id="Exponential-Decay-Fitting-1"></a><a class="docs-heading-anchor-permalink" href="#Exponential-Decay-Fitting" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="SpectroscopyTools.fit_exp_decay"><a class="docstring-binding" href="#SpectroscopyTools.fit_exp_decay"><code>SpectroscopyTools.fit_exp_decay</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">fit_exp_decay(trace::TATrace; n_exp=1, irf=false, irf_width=0.15, t_start=0.0, t_range=nothing)</code></pre><p>Fit exponential decay to a transient absorption trace.</p><p><strong>Arguments</strong></p><ul><li><code>trace</code>: TATrace</li><li><code>n_exp</code>: Number of exponential components (default 1)</li><li><code>irf</code>: Include IRF convolution (default false)</li><li><code>irf_width</code>: Initial guess for IRF σ in ps (default 0.15)</li><li><code>t_start</code>: Start time for fitting when irf=false (default 0.0)</li><li><code>t_range</code>: Optional (t<em>min, t</em>max) to restrict fit region</li></ul><p><strong>Returns</strong></p><ul><li><code>n_exp=1</code>: <code>ExpDecayFit</code></li><li><code>n_exp&gt;1</code>: <code>MultiexpDecayFit</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/fitting.jl#L131-L147">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.fit_global"><a class="docstring-binding" href="#SpectroscopyTools.fit_global"><code>SpectroscopyTools.fit_global</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">fit_global(traces::Vector{TATrace}; n_exp=1, irf_width=0.15, labels=nothing) -&gt; GlobalFitResult</code></pre><p>Fit multiple traces simultaneously with shared time constant(s) τ.</p><p>Supports single-exponential (<code>n_exp=1</code>) and multi-exponential (<code>n_exp&gt;1</code>) global analysis. All traces share the same time constants, IRF width, and time zero, while amplitudes and offsets are fitted per-trace.</p><p><strong>Keywords</strong></p><ul><li><code>n_exp::Int=1</code>: Number of exponential components</li><li><code>irf_width::Float64=0.15</code>: Initial guess for IRF σ in ps</li><li><code>labels=nothing</code>: Optional trace labels (defaults to &quot;Trace 1&quot;, &quot;Trace 2&quot;, ...)</li></ul><p><strong>Returns</strong></p><p><code>GlobalFitResult</code> with shared <code>taus</code> and per-trace <code>amplitudes</code> matrix.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Single-exponential global fit
result = fit_global([trace_esa, trace_gsb])

# Multi-exponential with 2 shared time constants
result = fit_global([trace1, trace2, trace3]; n_exp=2)
report(result)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/fitting.jl#L330-L356">source</a></section><section><div><pre><code class="language-julia hljs">fit_global(matrix::TAMatrix; n_exp=1, irf_width=0.15, λ=nothing) -&gt; GlobalFitResult</code></pre><p>Global analysis of a TAMatrix, extracting traces at each wavelength.</p><p>Returns a <code>GlobalFitResult</code> with the <code>wavelengths</code> field populated, enabling decay-associated spectra (DAS) via <code>das(result)</code>.</p><p><strong>Keywords</strong></p><ul><li><code>n_exp::Int=1</code>: Number of exponential components</li><li><code>irf_width::Float64=0.15</code>: Initial guess for IRF σ in ps</li><li><code>λ=nothing</code>: Specific wavelengths to fit. If <code>nothing</code>, fits all wavelengths.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">result = fit_global(matrix; n_exp=2)
report(result)

# Get decay-associated spectra
spectra = das(result)  # n_exp × n_wavelengths matrix</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/fitting.jl#L474-L495">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.ExpDecayFit"><a class="docstring-binding" href="#SpectroscopyTools.ExpDecayFit"><code>SpectroscopyTools.ExpDecayFit</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">ExpDecayFit</code></pre><p>Result of exponential decay fitting with instrument response function convolution.</p><p><strong>Fields</strong></p><ul><li><code>amplitude</code>, <code>tau</code>, <code>t0</code>, <code>sigma</code>, <code>offset</code>, <code>signal_type</code>, <code>residuals</code>, <code>rsquared</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/types.jl#L346-L353">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.MultiexpDecayFit"><a class="docstring-binding" href="#SpectroscopyTools.MultiexpDecayFit"><code>SpectroscopyTools.MultiexpDecayFit</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">MultiexpDecayFit</code></pre><p>Result of multi-exponential decay fitting (n &gt;= 1 components).</p><p><strong>Fields</strong></p><ul><li><code>taus::Vector{Float64}</code>: Time constants (sorted fast-&gt;slow)</li><li><code>amplitudes::Vector{Float64}</code>: Corresponding amplitudes</li><li><code>t0</code>, <code>sigma</code>, <code>offset</code>, <code>signal_type</code>, <code>residuals</code>, <code>rsquared</code></li></ul><p><strong>Derived properties</strong></p><ul><li><code>n_exp(fit)</code>: Number of exponential components</li><li><code>weights(fit)</code>: Relative amplitude weights (normalized to 100%)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/types.jl#L390-L403">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.GlobalFitResult"><a class="docstring-binding" href="#SpectroscopyTools.GlobalFitResult"><code>SpectroscopyTools.GlobalFitResult</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">GlobalFitResult</code></pre><p>Result of global fitting multiple traces with shared time constants.</p><p>Supports single-exponential (n<em>exp=1) and multi-exponential (n</em>exp&gt;1) global analysis with shared τ values and per-trace amplitudes.</p><p><strong>Fields</strong></p><ul><li><code>taus::Vector{Float64}</code>: Shared time constants (sorted fast→slow)</li><li><code>sigma::Float64</code>: Shared IRF width</li><li><code>t0::Float64</code>: Shared time zero</li><li><code>amplitudes::Matrix{Float64}</code>: Per-trace amplitudes (n<em>traces × n</em>exp)</li><li><code>offsets::Vector{Float64}</code>: Per-trace offsets</li><li><code>labels::Vector{String}</code>: Trace labels</li><li><code>wavelengths::Union{Nothing, Vector{Float64}}</code>: Wavelength axis (from TAMatrix input)</li><li><code>rsquared::Float64</code>: Global R²</li><li><code>rsquared_individual::Vector{Float64}</code>: Per-trace R²</li><li><code>residuals::Vector{Vector{Float64}}</code>: Per-trace residuals</li></ul><p><strong>Derived properties</strong></p><ul><li><code>n_exp(fit)</code>: Number of exponential components</li><li><code>das(fit)</code>: Decay-associated spectra (requires TAMatrix input)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/types.jl#L800-L823">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.das"><a class="docstring-binding" href="#SpectroscopyTools.das"><code>SpectroscopyTools.das</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">das(fit::GlobalFitResult) -&gt; Matrix{Float64}</code></pre><p>Return the decay-associated spectra (DAS) as an <code>n_exp × n_wavelengths</code> matrix. Each row is the amplitude spectrum for one time constant.</p><p>Requires that the fit was performed on a <code>TAMatrix</code> (wavelengths must be available).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/types.jl#L839-L846">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.report"><a class="docstring-binding" href="#SpectroscopyTools.report"><code>SpectroscopyTools.report</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">report(result)</code></pre><p>Print a formatted summary of a fit result to the terminal.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/types.jl#L897-L901">source</a></section></details></article><h2 id="Baseline-Correction"><a class="docs-heading-anchor" href="#Baseline-Correction">Baseline Correction</a><a id="Baseline-Correction-1"></a><a class="docs-heading-anchor-permalink" href="#Baseline-Correction" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="SpectroscopyTools.als_baseline"><a class="docstring-binding" href="#SpectroscopyTools.als_baseline"><code>SpectroscopyTools.als_baseline</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">als_baseline(y; λ=1e5, p=0.01, maxiter=10, tol=1e-6) -&gt; Vector</code></pre><p>Asymmetric Least Squares baseline correction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/baseline.jl#L14-L18">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.arpls_baseline"><a class="docstring-binding" href="#SpectroscopyTools.arpls_baseline"><code>SpectroscopyTools.arpls_baseline</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">arpls_baseline(y; λ=1e5, maxiter=100, tol=1e-6) -&gt; Vector</code></pre><p>Asymmetrically Reweighted Penalized Least Squares baseline correction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/baseline.jl#L60-L64">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.snip_baseline"><a class="docstring-binding" href="#SpectroscopyTools.snip_baseline"><code>SpectroscopyTools.snip_baseline</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">snip_baseline(y; iterations=40, decreasing=true) -&gt; Vector</code></pre><p>SNIP baseline correction using iterative peak clipping.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/baseline.jl#L116-L120">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.correct_baseline"><a class="docstring-binding" href="#SpectroscopyTools.correct_baseline"><code>SpectroscopyTools.correct_baseline</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">correct_baseline(y; method=:arpls, kwargs...) -&gt; NamedTuple</code></pre><p>Correct baseline and return both corrected spectrum and baseline.</p><p>Returns <code>(y=corrected, baseline=baseline)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/baseline.jl#L165-L171">source</a></section><section><div><pre><code class="language-julia hljs">correct_baseline(x, y; kwargs...) -&gt; NamedTuple</code></pre><p>Version that also returns x values for convenience.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/baseline.jl#L190-L194">source</a></section></details></article><h2 id="Spectroscopy-Utilities"><a class="docs-heading-anchor" href="#Spectroscopy-Utilities">Spectroscopy Utilities</a><a id="Spectroscopy-Utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Spectroscopy-Utilities" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="SpectroscopyTools.normalize"><a class="docstring-binding" href="#SpectroscopyTools.normalize"><code>SpectroscopyTools.normalize</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">normalize(x)</code></pre><p>Normalize array by maximum absolute value. Returns zeros if max is zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/spectroscopy.jl#L7-L11">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.smooth_data"><a class="docstring-binding" href="#SpectroscopyTools.smooth_data"><code>SpectroscopyTools.smooth_data</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">smooth_data(y; window=3)</code></pre><p>Apply moving average smoothing to data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/spectroscopy.jl#L126-L130">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.calc_fwhm"><a class="docstring-binding" href="#SpectroscopyTools.calc_fwhm"><code>SpectroscopyTools.calc_fwhm</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">calc_fwhm(x, y; smooth_window=5)</code></pre><p>Calculate full width at half maximum (FWHM) of the dominant positive peak.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/spectroscopy.jl#L146-L150">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.subtract_spectrum"><a class="docstring-binding" href="#SpectroscopyTools.subtract_spectrum"><code>SpectroscopyTools.subtract_spectrum</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">subtract_spectrum(sample, reference; scale=1.0, interpolate=false)</code></pre><p>Subtract a reference spectrum from a sample spectrum.</p><p>Accepts <code>AbstractSpectroscopyData</code> types (uses <code>xdata</code>/<code>ydata</code> interface) or any objects with <code>.x</code> and <code>.y</code> fields.</p><p>Returns <code>(x=..., y=...)</code> NamedTuple.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/spectroscopy.jl#L59-L68">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.transmittance_to_absorbance"><a class="docstring-binding" href="#SpectroscopyTools.transmittance_to_absorbance"><code>SpectroscopyTools.transmittance_to_absorbance</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">transmittance_to_absorbance(T; percent=false)</code></pre><p>Convert transmittance to absorbance: <code>A = -log10(T)</code>. Input <code>T</code> is fractional (0 to 1). Use <code>percent=true</code> for percent transmittance.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/spectroscopy.jl#L25-L30">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.absorbance_to_transmittance"><a class="docstring-binding" href="#SpectroscopyTools.absorbance_to_transmittance"><code>SpectroscopyTools.absorbance_to_transmittance</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">absorbance_to_transmittance(A; percent=false)</code></pre><p>Convert absorbance to transmittance: <code>T = 10^(-A)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/spectroscopy.jl#L41-L45">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.npoints"><a class="docstring-binding" href="#SpectroscopyTools.npoints"><code>SpectroscopyTools.npoints</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">npoints(d::AbstractSpectroscopyData) -&gt; Int
npoints(d::TAMatrix) -&gt; Tuple{Int,Int}</code></pre><p>Return the number of data points. For 1D data, returns an <code>Int</code>. For 2D data (<code>TAMatrix</code>), returns <code>(n_time, n_wavelength)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/types.jl#L60-L66">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.source_file"><a class="docstring-binding" href="#SpectroscopyTools.source_file"><code>SpectroscopyTools.source_file</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">source_file(d::AbstractSpectroscopyData) -&gt; String</code></pre><p>Return the source filename for the data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/types.jl#L53-L57">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.title"><a class="docstring-binding" href="#SpectroscopyTools.title"><code>SpectroscopyTools.title</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">title(d::AbstractSpectroscopyData) -&gt; String</code></pre><p>Return a display title for the data. Defaults to <code>source_file(d)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/types.jl#L69-L73">source</a></section></details></article><h2 id="Unit-Conversions"><a class="docs-heading-anchor" href="#Unit-Conversions">Unit Conversions</a><a id="Unit-Conversions-1"></a><a class="docs-heading-anchor-permalink" href="#Unit-Conversions" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="SpectroscopyTools.wavenumber_to_wavelength"><a class="docstring-binding" href="#SpectroscopyTools.wavenumber_to_wavelength"><code>SpectroscopyTools.wavenumber_to_wavelength</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">wavenumber_to_wavelength(ν̃; output_unit=u&quot;nm&quot;)</code></pre><p>Convert wavenumber (cm⁻¹) to wavelength.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/units.jl#L20-L24">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.wavelength_to_wavenumber"><a class="docstring-binding" href="#SpectroscopyTools.wavelength_to_wavenumber"><code>SpectroscopyTools.wavelength_to_wavenumber</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">wavelength_to_wavenumber(λ; output_unit=u&quot;cm^-1&quot;)</code></pre><p>Convert wavelength to wavenumber. Input assumed in nm if unitless.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/units.jl#L37-L41">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.wavenumber_to_energy"><a class="docstring-binding" href="#SpectroscopyTools.wavenumber_to_energy"><code>SpectroscopyTools.wavenumber_to_energy</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">wavenumber_to_energy(ν̃; output_unit=u&quot;eV&quot;)</code></pre><p>Convert wavenumber (cm⁻¹) to photon energy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/units.jl#L60-L64">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.wavelength_to_energy"><a class="docstring-binding" href="#SpectroscopyTools.wavelength_to_energy"><code>SpectroscopyTools.wavelength_to_energy</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">wavelength_to_energy(λ; output_unit=u&quot;eV&quot;)</code></pre><p>Convert wavelength to photon energy. Input assumed in nm if unitless.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/units.jl#L76-L80">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.energy_to_wavelength"><a class="docstring-binding" href="#SpectroscopyTools.energy_to_wavelength"><code>SpectroscopyTools.energy_to_wavelength</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">energy_to_wavelength(E; output_unit=u&quot;nm&quot;)</code></pre><p>Convert photon energy to wavelength. Input assumed in eV if unitless.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/units.jl#L92-L96">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.linewidth_to_decay_time"><a class="docstring-binding" href="#SpectroscopyTools.linewidth_to_decay_time"><code>SpectroscopyTools.linewidth_to_decay_time</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">linewidth_to_decay_time(Γ; output_unit=u&quot;ps&quot;)</code></pre><p>Convert spectral linewidth (FWHM) to decay time: τ = ℏ/Γ. Input assumed in meV if unitless.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/units.jl#L130-L135">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectroscopyTools.decay_time_to_linewidth"><a class="docstring-binding" href="#SpectroscopyTools.decay_time_to_linewidth"><code>SpectroscopyTools.decay_time_to_linewidth</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">decay_time_to_linewidth(τ; output_unit=u&quot;meV&quot;)</code></pre><p>Convert excited-state decay time to natural linewidth (FWHM): Γ = ℏ/τ. Input assumed in ps if unitless.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/garrekstemo/SpectroscopyTools.jl/blob/0fbeb9b9ba09dc41299a1da9e30080a2e9f03da9/src/units.jl#L112-L117">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorials/chirp_correction/">« Chirp Correction</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.17.0 on <span class="colophon-date" title="Sunday 22 February 2026 12:05">Sunday 22 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
